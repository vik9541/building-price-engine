# üèóÔ∏è Building Price Engine - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω–∞–º–∏

**–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π** –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥** –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ (–ü–µ—Ç—Ä–æ–≤–∏—á, Leroy Merlin, Obi)  
‚úÖ **24/7 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω** - –∫–∞–∂–¥—ã–π —á–∞—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ  
‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã** - —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã  
‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏** - —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ —Ö—Ä–∞–Ω–∏—Ç —Ñ–æ—Ç–æ  
‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç –≤–∞—à–∏—Ö —Ü–µ–Ω  
‚úÖ **REST API** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∞–π—Ç–æ–º  
‚úÖ **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏  
‚úÖ **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã  

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
building-price-engine/
‚îú‚îÄ‚îÄ backend/                    # Python FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py            # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas.py         # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py        # PostgreSQL + Redis
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/               # REST endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ competitors.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prices.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parsers/           # –ü–∞—Ä—Å–µ—Ä—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ petrov_parser.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ leroy_parser.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ obi_parser.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks/             # Celery –∑–∞–¥–∞—á–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parse_competitors.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ update_prices.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ calculate_strategy.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pricing/           # –¶–µ–Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ strategy.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ calculator.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ image_handler.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ helpers.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/                   # React –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml         # –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
‚îú‚îÄ‚îÄ nginx.conf                 # –ö–æ–Ω—Ñ–∏–≥ –ø—Ä–æ–∫—Å–∏
‚îî‚îÄ‚îÄ docs/                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ SETUP.md
    ‚îú‚îÄ‚îÄ API.md
    ‚îú‚îÄ‚îÄ PARSERS.md
    ‚îî‚îÄ‚îÄ PRICING_STRATEGY.md
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ
```bash
git clone https://github.com/vik9541/building-price-engine.git
cd building-price-engine
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp backend/.env.example backend/.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ backend/.env
```

### 3. –ó–∞–ø—É—Å–∫ —Å Docker
```bash
docker-compose up -d
```

–°–µ—Ä–≤–∏—Å—ã:
- **Backend API**: http://localhost:8000
- **Swagger UI**: http://localhost:8000/docs
- **Admin Panel**: http://localhost:3000
- **PostgreSQL**: localhost:5432
- **Redis**: localhost:6379

### 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
```bash
docker-compose exec backend python -m alembic upgrade head
```

### 5. –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–æ–≤
```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
celery -A app.tasks worker --loglevel=info
```

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –¢–æ–≤–∞—Ä—ã
```
GET    /api/products              # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤
POST   /api/products              # –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
GET    /api/products/{id}         # –î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞
PUT    /api/products/{id}         # –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
DELETE /api/products/{id}         # –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
```

### –¶–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
```
GET    /api/competitors           # –°–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
GET    /api/prices/{product_id}   # –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
GET    /api/prices/compare        # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–æ–º
```
POST   /api/admin/parse/petrov    # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä –ü–µ—Ç—Ä–æ–≤–∏—á–∞
POST   /api/admin/parse/leroy     # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä Leroy Merlin
POST   /api/admin/parse/obi       # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä Obi
GET    /api/admin/parse/status    # –°—Ç–∞—Ç—É—Å –ø–∞—Ä—Å–∏–Ω–≥–∞
```

### –¶–µ–Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
```
GET    /api/pricing/strategy      # –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
PUT    /api/pricing/strategy      # –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
POST   /api/pricing/calculate     # –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—ã
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### backend/.env
```env
# Database
DATABASE_URL=postgresql://user:password@postgres:5432/building_db
REDIS_URL=redis://redis:6379/0

# Parsers
PETROV_URL=https://www.petrov.ru
LEROY_URL=https://www.leroymerlin.ru
OBI_URL=https://www.obi.ru

# Parsing schedule (in minutes)
PARSE_INTERVAL=60
PRICE_CHECK_INTERVAL=30

# Pricing strategy
MARKUP_MIN=10          # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ %
MARKUP_MAX=30          # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ %
COMPETITOR_WEIGHT=0.7  # –í–µ—Å —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤

# API
API_WORKERS=4
API_PORT=8000
API_DEBUG=False
```

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### 1. –ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤ (–∫–∞–∂–¥—ã–π —á–∞—Å)
1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∞–π—Ç—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
2. –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ü–µ–Ω–∞, —Ñ–æ—Ç–æ, –∞—Ä—Ç–∏–∫—É–ª
4. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
2. –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î
3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

### 3. –¶–µ–Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ (–∫–∞–∂–¥—ã–π —á–∞—Å)
1. –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
2. –†–∞—Å—á—ë—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìà –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

–î–≤–∏–∂–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–º–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º**:

```python
# –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:
price = cost * (1 + min_markup)

# –° —É—á—ë—Ç–æ–º –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤:
competitor_avg = average(competitors_prices)
if competitor_avg > price * 1.15:
    price = competitor_avg * 0.95  # 95% –æ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
elif competitor_avg < price * 0.85:
    price = competitor_avg * 1.05  # 105% –æ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞

# –° —É—á—ë—Ç–æ–º –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏:
if sales > avg_sales * 1.5:
    price = price * 0.95  # –°–Ω–∏–∑–∏—Ç—å —Ü–µ–Ω—É –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
elif sales < avg_sales * 0.5:
    price = price * 1.10  # –ü–æ–≤—ã—Å–∏—Ç—å –¥–ª—è –Ω–µ–ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Rate limiting –Ω–∞ API
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ HTTPS –¥–ª—è –ø–∞—Ä—Å–µ—Ä–æ–≤ (User-Agent,Proxy support)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- –£—Å–ø–µ—à–Ω—ã–µ/–Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–∞—Ä—Å–∏–Ω–≥–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω
- –û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```
logs/
‚îú‚îÄ‚îÄ parser_2026-01-11.log
‚îú‚îÄ‚îÄ pricing_2026-01-11.log
‚îú‚îÄ‚îÄ api_2026-01-11.log
‚îî‚îÄ‚îÄ errors_2026-01-11.log
```

## üêõ Troubleshooting

### –ü–∞—Ä—Å–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É
docker-compose exec backend curl https://www.petrov.ru
```

### –ë–î –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redis
docker-compose exec redis redis-cli ping

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Celery
docker-compose restart celery
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](docs/SETUP.md)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/API.md)
- [–ü–∞—Ä—Å–µ—Ä—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤](docs/PARSERS.md)
- [–¶–µ–Ω–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è](docs/PRICING_STRATEGY.md)

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–í–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã? –û—Ç–∫—Ä–æ–π—Ç–µ issue –Ω–∞ GitHub.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 11.01.2026
